use [EMPLOYEE_Views]
go

select distinct


EMP.EMPLOYEE_ID
,RTRIM(EMP.PREFERRED_NAME) AS [FIRST NAME]
,RTRIM(EMP.LAST_NAME) AS [LAST NAME]
,RTRIM(EMP.EMAIL_WORK_ADDRESS) AS [EMPLOYEE EMAIL ADDRESS]
,DATEPART(YYYY, EMP.BIRTH_DATE) AS [BIRTH YEAR]
,AGE = DATEDIFF(DAYOFYEAR, GETDATE()) -
  CASE WHEN DATEPART(DAYOFYEAR, GETDATE()) <
      DATEPART(DAYOFYEAR, EMP.BIRTH_DATE) THEN 1 ELSE 0 END
,CASE WHEN DATEPART(YYY, EMP.BIRTH_DATE) < 1946 THEN 'SILENT (<1946)'
  WHEN DATEPART(YYY, EMP.BIRTH_DATE) BETWEEN 1946 AND 1964 THEN 'BABY BOOMERS (1946-1964)'
  WHEN DATEPART(YYY, EMP.BIRTH_DATE) BETWEEN 1965 AND 1979 THEN 'GENERATION X (1965 - 1979)'
  WHEN DATEPART(YYY, EMP.BIRTH_DATE) BETWEEN 1980 AND 1997 THEN 'MELLENNIALS (1980 - 1997)'
  WHEN DATEPART(YYY, EMP.BIRTH_DATE) > 1997 THEN 'GENERATION Z (> 1997)' 
  ELSE '' END AS [GENERATION]
,EMP.REHIRE_DATE AS [HIRE DATE]
,CAST(ABS(DATEDIFF(DD, EMP.SERVICE_DATE, GETDATE())/365.25) AS DECIMAL(5,2)) AS [YEARS OF SERVICE]
,EMP.FTE AS [FTE]
,HRCOMM.SFNAME AS [SUBFUNCTION]
,HRCOMM.FNNAME AS [FUNCTION]
,HRCOMM.ENTNAME AS [ENTITY]
,HRL.HRLOCATION
,HRL.DESCRIPTION AS [LOCATION DESC]
,EMP.JOB_CODE [JOB CODE]
,EMP.JOB_TITLE [JOB TITLE]
,EMP.POSITION [POSITION CODE]
,EMP.POSITION_TITLE [POSITION TITLE]
,EMP.DEPARTMENT_NAME AS [DEPARTMENT DESC]
,STUFF(EMP.DEPARTMENT_NAME, 1, 7,'') AS [DEPARTMENT NAME]
,SUBSTRING(WA.COSTCENTER, 5, 6) AS [PLCC]
,RTRIM(EMPTBL.NPREFERREDGIVENNAME) AS [SUPERVISOR FIRST NAME]
,RTRIM(EMPTBL.NFAMILYNAME) AS [SUPERVISOR LAST NAME]
,EMP.SUPERVISOR_AHSN AS [SUPERVISOR ASHN]
,RTRIM(SUPERVISOR_EMAIL) AS [SUPERVISOR EMAIL ADDRESS]
,EMP.SUPERVISOR_POSITION AS [SUPERVISOR POSITION]
,EMP.STATUS 
,UFS.ALPHA
,CASE WHEN UFS.ALPHA = '1' THEN 'SYSTEM CHIEF EXECUTIVE OFFICER'
  WHEN UFS.ALPHA = '2' THEN 'SYSTEM PRESIDENT'
  WHEN UFS.ALPHA = '3' THEN 'SYSTEM SVP OPERATIONS/CFO'
  WHEN UFS.ALPHA = '4' THEN 'DIVISION PRESIDENT/SYS SVP CMO/CNO'
  WHEN UFS.ALPHA = '5' THEN 'CAO/DIVISION VP/SYSTEM VP'
  WHEN UFS.ALPHA = '6' THEN 'EXEC DIRECTOR/SYS AVP/SYSDIR/VP OPS'
  WHEN UFS.ALPHA = '7' THEN 'DIRECTOR/MEDICAL DIRECTOR'
  WHEN UFS.ALPHA = '8' THEN 'MANAGER/NURSE MANAGER/PRACTICE MANAGER/SOUS CHEF/LAB CHIEF'
  WHEN UFS.ALPHA = '9' THEN 'ASST MANAGER/ASST NURSE MANAGER/HOUSE SUPV/SUPV'
  WHEN UFS.ALPHA = '10' THEN 'NON-MANAGER' 
  ELSE '' END AS [CHECK REQUEST LEVEL]
,EMP.RELATIONHSHIPTOORG

FROM [DBO].[VWEMPLOYEECURRENTALLEMPLOYEE_EMPLOYEE] AS [EMP] LEFT JOIN [LSPROD_ME].[HCM].[WORKASSIGNMENT_EMP_CURRENT] AS WA WITH (NOLOCK)











